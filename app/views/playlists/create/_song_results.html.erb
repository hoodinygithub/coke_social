<%
  song_sort_class = ""
  artist_sort_class = ""
  album_sort_class = ""
  
  song_sort_class = (params[:order_dir]=="DESC" ? "sort_desc" : "sort_asc") if params[:order_by] == "song"
  artist_sort_class = (params[:order_dir]=="DESC" ? "sort_desc" : "sort_asc") if params[:order_by] == "artist"
  album_sort_class = (params[:order_dir]=="DESC" ? "sort_desc" : "sort_asc") if params[:order_by] == "album"
%>

<div class="songs_list my_mix remove_index">
  <div class="headers">
    <% if @item_id %>
      <div class="song_name upper sortable <%= song_sort_class %>" onclick="do_song_list_sort(this, <%=@item_id %>, '<%=@scope %>', 'song');"><%= t('basics.song_name') %></div>
      <div class="artist_name upper sortable <%= artist_sort_class %>" onclick="do_song_list_sort(this, <%=@item_id %>, '<%=@scope %>', 'artist');"><%= t('basics.artist') %></div>
      <div class="album_name upper sortable <%= album_sort_class %>" onclick="do_song_list_sort(this, <%=@item_id %>, '<%=@scope %>', 'album');"><%= t('basics.album') %></div>
    <% else %>
      <div class="song_name upper sortable <%= song_sort_class %>" onclick="do_search_list_sort(this, '<%=escape_for_js(@result_text) %>', '<%=@scope %>', 'song');"><%= t('basics.song_name') %></div>
      <div class="artist_name upper sortable <%= artist_sort_class %>" onclick="do_search_list_sort(this, '<%=escape_for_js(@result_text) %>', '<%=@scope %>', 'artist');"><%= t('basics.artist') %></div>
      <div class="album_name upper sortable <%= album_sort_class %>" onclick="do_search_list_sort(this, '<%=escape_for_js(@result_text) %>', '<%=@scope %>', 'album');"><%= t('basics.album') %></div>
    <% end %>
    <div class="large_bnt">&nbsp;</div>
    <div class="last">&nbsp;</div>

    <br class="clearer" />
  </div><!--/end headers -->

  <div class="songs_box medium_height">
    <ul class="hoverable_list" id="result_container">
      <% @results.each do |song| %>
        <% unless song.artist.nil? || song.album.nil? %>
          <li id="search_result_<%= song.id %>" class="draggable_item">
              <div class="song_image"><%= avatar_for song, :small%></div>
              <div class="song_name">
                <%= link_to_function image_tag("icon_play_button.png", :class => "png_fix icon_play_button"), "Base.playlists.playStream(this, 'http://media.cyloop.com/storage/storage?fileName=#{song.path}', '#{song.id}')"%>
                  &nbsp; <%= truncate(song.title, :length => 20) %>
              </div>

              <div class="artist_name"><b><%= truncate(song.artist.name, :length => 20) %></b></div>
              <div class="album_name"><%= truncate(song.album.name, :length => 16) %></div>
              <div class="large_bnt">
                <b><a href="#" class="black" onclick="add_item_wrapper(<%= song.id %>, '<%= escape_for_js(song.title) %>', <%= song.artist.id %>, '<%= escape_for_js(song.artist.name) %>', <%= song.album.id %>, '<%= escape_for_js(song.album.name) %>', '<%= AvatarsHelper.avatar_path( song, :small ) %>', false); remove_search_result(<%= song.id %>); return false;">+</a></b></div>

              <br class="clearer" />
          </li>
        <% end %>
        
      <% end %>
    </ul>
  </div><!--/end songs_box -->
</div><!--/end songs_list -->
<script language="javascript">
  
  Base.playlists.onStreamStart = function(obj)
  {
    $(obj).find('.large_bnt a').hide();
  }
  Base.playlists.onStreamEnd = function(obj)
  {
    $(obj).find('.large_bnt a').show();
  }
</script>
